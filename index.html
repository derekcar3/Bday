<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy 33rd Birthday - Caf√© Literary Quest</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
Copy    body {
        font-family: 'Georgia', serif;
        background: linear-gradient(135deg, #8B4513, #D2691E, #CD853F);
        overflow: hidden;
        touch-action: manipulation;
        user-select: none;
    }

    #gameContainer {
        width: 100vw;
        height: 100vh;
        position: relative;
        background: 
            radial-gradient(circle at 20% 20%, rgba(255,215,0,0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 60%, rgba(255,140,0,0.1) 0%, transparent 50%),
            linear-gradient(45deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
        background-attachment: fixed;
    }

    .bookshelf {
        position: absolute;
        width: 80px;
        height: 140px;
        background: linear-gradient(90deg, #654321 0%, #8B4513 50%, #654321 100%);
        border: 3px solid #4A4A4A;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .bookshelf:before {
        content: '';
        position: absolute;
        top: 25px;
        left: 8px;
        right: 8px;
        height: 20px;
        background: repeating-linear-gradient(90deg, #FF6B6B 0px, #FF6B6B 12px, #4ECDC4 12px, #4ECDC4 24px, #45B7D1 24px, #45B7D1 36px, #96CEB4 36px, #96CEB4 48px);
        border-radius: 3px;
    }

    .bookshelf:after {
        content: '';
        position: absolute;
        bottom: 25px;
        left: 8px;
        right: 8px;
        height: 20px;
        background: repeating-linear-gradient(90deg, #DDA0DD 0px, #DDA0DD 12px, #F0E68C 12px, #F0E68C 24px, #FFB6C1 24px, #FFB6C1 36px, #98FB98 36px, #98FB98 48px);
        border-radius: 3px;
    }

    .cafe-table {
        position: absolute;
        width: 60px;
        height: 60px;
        background: radial-gradient(circle, #8B4513 30%, #654321 70%);
        border-radius: 50%;
        border: 4px solid #4A4A4A;
        box-shadow: 0 6px 12px rgba(0,0,0,0.4);
    }

    .cafe-table:after {
        content: '‚òï';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
    }

    #player {
        position: absolute;
        width: 60px;
        height: 60px;
        background: linear-gradient(45deg, #FF6B9D, #FF8E53);
        border-radius: 50%;
        border: 4px solid #FFF;
        transition: all 0.1s ease;
        z-index: 100;
        box-shadow: 0 6px 12px rgba(0,0,0,0.4);
    }

    #player:before {
        content: 'üë©‚Äçü¶∞';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 32px;
    }

    .kid {
        position: absolute;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: 3px solid #FFF;
        transition: all 0.3s ease;
        z-index: 90;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    #cassian {
        background: linear-gradient(45deg, #4ECDC4, #45B7D1);
    }

    #cassian:before {
        content: 'üë¶';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 28px;
    }

    #charlie {
        background: linear-gradient(45deg, #FFB6C1, #FF69B4);
    }

    #charlie:before {
        content: 'üëß';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 28px;
    }

    .speech-bubble {
        position: absolute;
        background: white;
        border-radius: 20px;
        padding: 8px 12px;
        border: 3px solid #333;
        font-size: 12px;
        font-weight: bold;
        color: #333;
        white-space: nowrap;
        z-index: 150;
        animation: bubble-appear 0.3s ease-out, bubble-disappear 0.3s ease-in 2.7s forwards;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .speech-bubble:after {
        content: '';
        position: absolute;
        bottom: -8px;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-top: 8px solid white;
    }

    .speech-bubble:before {
        content: '';
        position: absolute;
        bottom: -11px;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 11px solid transparent;
        border-right: 11px solid transparent;
        border-top: 11px solid #333;
    }

    @keyframes bubble-appear {
        0% { opacity: 0; transform: scale(0.5) translateY(10px); }
        100% { opacity: 1; transform: scale(1) translateY(0); }
    }

    @keyframes bubble-disappear {
        0% { opacity: 1; transform: scale(1); }
        100% { opacity: 0; transform: scale(0.8); }
    }

    .collectible {
        position: absolute;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        animation: float 2s ease-in-out infinite;
        z-index: 50;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .book {
        background: linear-gradient(45deg, #4ECDC4, #45B7D1);
        border: 3px solid #FFF;
    }

    .book:before {
        content: 'üìö';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
    }

    .coffee {
        background: linear-gradient(45deg, #D2691E, #8B4513);
        border: 3px solid #FFF;
    }

    .coffee:before {
        content: '‚òï';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
    }

    .healthy-snack {
        background: linear-gradient(45deg, #98FB98, #90EE90);
        border: 3px solid #FFF;
    }

    .healthy-snack:before {
        content: 'ü•ó';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
    }

    .running-shoe {
        background: linear-gradient(45deg, #FF1493, #FF69B4);
        border: 3px solid #FFF;
    }

    .running-shoe:before {
        content: 'üëü';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
    }

    .croissant {
        background: linear-gradient(45deg, #DEB887, #F4A460);
        border: 3px solid #FFF;
    }

    .croissant:before {
        content: 'ü•ê';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
    }

    .tea {
        background: linear-gradient(45deg, #228B22, #32CD32);
        border: 3px solid #FFF;
    }

    .tea:before {
        content: 'üçµ';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
    }

    /* Negative items */
    .dirty-dish {
        background: linear-gradient(45deg, #DC143C, #B22222);
        border: 3px solid #8B0000;
        animation: float 2s ease-in-out infinite, pulse-red 1s ease-in-out infinite;
    }

    .dirty-dish:before {
        content: 'üçΩÔ∏è';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
        filter: hue-rotate(0deg) saturate(2);
    }

    .laundry {
        background: linear-gradient(45deg, #8B4513, #A0522D);
        border: 3px solid #654321;
        animation: float 2s ease-in-out infinite, pulse-brown 1s ease-in-out infinite;
    }

    .laundry:before {
        content: 'üëî';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 26px;
        filter: saturate(0.5);
    }

    @keyframes float {
        0%, 100% { transform: translateY(0px); }
        50% { transform: translateY(-15px); }
    }

    @keyframes pulse-red {
        0%, 100% { box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 0 0 rgba(220, 20, 60, 0.4); }
        50% { box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 0 10px rgba(220, 20, 60, 0); }
    }

    @keyframes pulse-brown {
        0%, 100% { box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 0 0 rgba(139, 69, 19, 0.4); }
        50% { box-shadow: 0 4px 8px rgba(0,0,0,0.2), 0 0 0 10px rgba(139, 69, 19, 0); }
    }

    @keyframes screen-shake {
        0%, 100% { transform: translate(0, 0); }
        10% { transform: translate(-5px, -5px); }
        20% { transform: translate(5px, -5px); }
        30% { transform: translate(-5px, 5px); }
        40% { transform: translate(5px, 5px); }
        50% { transform: translate(-5px, -5px); }
        60% { transform: translate(5px, -5px); }
        70% { transform: translate(-5px, 5px); }
        80% { transform: translate(5px, 5px); }
        90% { transform: translate(-5px, -5px); }
    }

    .screen-shake {
        animation: screen-shake 0.5s ease-in-out;
    }

    #ui {
        position: fixed;
        top: 20px;
        left: 20px;
        right: 20px;
        z-index: 200;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    #score, #timer {
        background: rgba(0,0,0,0.8);
        color: #FFD700;
        padding: 12px 18px;
        border-radius: 25px;
        font-size: 20px;
        font-weight: bold;
        border: 3px solid #FFD700;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    #popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #FFE4E1, #FFF0F5);
        padding: 30px;
        border-radius: 20px;
        border: 4px solid #FF69B4;
        text-align: center;
        z-index: 300;
        display: none;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        max-width: 90%;
    }

    #popup h2 {
        color: #FF1493;
        margin-bottom: 15px;
        font-size: 24px;
    }

    #popup p {
        color: #8B008B;
        font-size: 18px;
        margin-bottom: 20px;
        line-height: 1.4;
    }

    #popup button {
        background: linear-gradient(45deg, #FF69B4, #FF1493);
        color: white;
        border: none;
        padding: 12px 25px;
        border-radius: 25px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s;
    }

    #popup button:hover {
        transform: scale(1.05);
    }

    #startScreen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #8B4513, #D2691E);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 400;
        text-align: center;
        padding: 20px;
    }

    #startScreen h1 {
        color: #FFD700;
        font-size: 28px;
        margin-bottom: 20px;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    #startScreen p {
        color: #FFF;
        font-size: 16px;
        margin-bottom: 30px;
        line-height: 1.6;
    }

    #startButton {
        background: linear-gradient(45deg, #FF69B4, #FF1493);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 30px;
        font-size: 20px;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.2s;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    #startButton:hover {
        transform: scale(1.1);
    }

    .particle {
        position: absolute;
        width: 6px;
        height: 6px;
        background: #FFD700;
        border-radius: 50%;
        pointer-events: none;
        animation: particle-float 3s ease-out forwards;
    }

    @keyframes particle-float {
        0% {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        100% {
            opacity: 0;
            transform: translateY(-120px) scale(0);
        }
    }

    @media (max-height: 600px) {
        #startScreen h1 { font-size: 24px; }
        #startScreen p { font-size: 14px; }
        #popup h2 { font-size: 20px; }
        #popup p { font-size: 16px; }
        .collectible { width: 40px; height: 40px; }
        .collectible:before { font-size: 20px; }
    }
</style>
</head>
<body>
    <div id="startScreen">
        <h1>üéâ Happy 33rd Birthday! üéâ</h1>
        <p>Welcome to your personalized Caf√© Literary Quest!<br>
        Cassian and Charlie will chase you around with love!<br>
        Collect books, coffee, and healthy treats!<br>
        Avoid the dirty dishes and laundry!<br><br>
        üëÜ Tap anywhere to move<br>
        üìö Collect good items for points<br>
        üçΩÔ∏è Avoid red dishes and laundry<br>
        ‚è∞ Beat the clock!</p>
        <button id="startButton">Start Your Adventure!</button>
    </div>
Copy<div id="gameContainer">
    <div id="ui">
        <div id="score">Score: 0</div>
        <div id="timer">Time: 90</div>
    </div>
    <div id="player"></div>
    <div id="cassian" class="kid"></div>
    <div id="charlie" class="kid"></div>
</div>

<div id="popup">
    <h2 id="popupTitle"></h2>
    <p id="popupMessage"></p>
    <button onclick="closePopup()">Continue</button>
</div>

<script>
    // Game variables
    let score = 0;
    let timeLeft = 90;
    let gameRunning = false;
    let player = document.getElementById('player');
    let cassian = document.getElementById('cassian');
    let charlie = document.getElementById('charlie');
    let gameContainer = document.getElementById('gameContainer');
    let collectibles = [];
    let gameTimer;
    let spawnTimer;
    let bubbleTimer;
    
    // Player and kids positions
    let playerX = window.innerWidth / 2 - 30;
    let playerY = window.innerHeight / 2 - 30;
    let cassianX = window.innerWidth / 4;
    let cassianY = window.innerHeight / 3;
    let charlieX = (window.innerWidth * 3) / 4;
    let charlieY = (window.innerHeight * 2) / 3;
    
    // Table positions for better layout
    let tablePositions = [];
    
    // Encouraging messages from kids
    const kidMessages = [
        "You're the best mommy! üíï",
        "Go mommy go! üèÉ‚Äç‚ôÄÔ∏è",
        "We love you so much! ‚ù§Ô∏è",
        "You're so fast! ‚ö°",
        "Happy birthday mommy! üéâ",
        "You're amazing! ‚ú®",
        "Keep going! üí™",
        "You're our superhero! ü¶∏‚Äç‚ôÄÔ∏è",
        "We're so proud! üåü",
        "Best mommy ever! üëë"
    ];

    // Sound effects
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    
    function playSound(frequency, duration, type = 'sine') {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = frequency;
        oscillator.type = type;
        
        gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
        
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration);
    }

    function playCollectSound() {
        playSound(800, 0.2);
        setTimeout(() => playSound(1200, 0.1), 100);
    }

    function playNegativeSound() {
        playSound(200, 0.3, 'sawtooth');
    }

    function playWinSound() {
        const notes = [523, 659, 784, 1047];
        notes.forEach((note, index) => {
            setTimeout(() => playSound(note, 0.4), index * 200);
        });
    }

    // Initialize game
    function initGame() {
        updatePlayerPosition();
        updateKidsPositions();
        createStaticElements();
        
        // Touch controls
        gameContainer.addEventListener('touchstart', handleTouch, { passive: false });
        gameContainer.addEventListener('touchmove', handleTouch, { passive: false });
        gameContainer.addEventListener('click', handleClick);
        
        document.getElementById('startButton').addEventListener('click', startGame);
    }

    function createStaticElements() {
        // Create bookshelves in corners and edges
        const bookshelfPositions = [
            {x: 20, y: 120},
            {x: window.innerWidth - 100, y: 120},
            {x: 20, y: window.innerHeight - 260},
            {x: window.innerWidth - 100, y: window.innerHeight - 260},
            {x: window.innerWidth / 2 - 40, y: 120},
            {x: window.innerWidth / 4, y: window.innerHeight - 260}
        ];

        bookshelfPositions.forEach(pos => {
            const bookshelf = document.createElement('div');
            bookshelf.className = 'bookshelf';
            bookshelf.style.left = pos.x + 'px';
            bookshelf.style.top = pos.y + 'px';
            gameContainer.appendChild(bookshelf);
        });
        
        // Create caf√© tables in organized layout
        tablePositions = [
            {x: window.innerWidth / 4 - 30, y: window.innerHeight / 3},
            {x: (window.innerWidth * 3) / 4 - 30, y: window.innerHeight / 3},
            {x: window.innerWidth / 2 - 30, y: window.innerHeight / 2},
            {x: window.innerWidth / 4 - 30, y: (window.innerHeight * 2) / 3},
            {x: (window.innerWidth * 3) / 4 - 30, y: (window.innerHeight * 2) / 3}
        ];

        tablePositions.forEach(pos => {
            const table = document.createElement('div');
            table.className = 'cafe-table';
            table.style.left = pos.x + 'px';
            table.style.top = pos.y + 'px';
            gameContainer.appendChild(table);
        });
    }

    function handleTouch(e) {
        e.preventDefault();
        if (!gameRunning) return;
        
        const touch = e.touches[0] || e.changedTouches[0];
        movePlayerTo(touch.clientX, touch.clientY);
    }

    function handleClick(e) {
        if (!gameRunning) return;
        movePlayerTo(e.clientX, e.clientY);
    }

    function movePlayerTo(x, y) {
        playerX = Math.max(30, Math.min(window.innerWidth - 90, x - 30));
        playerY = Math.max(90, Math.min(window.innerHeight - 90, y - 30));
        updatePlayerPosition();
    }

    function updatePlayerPosition() {
        player.style.left = playerX + 'px';
        player.style.top = playerY + 'px';
    }

    function updateKidsPositions() {
        // Kids slowly follow the player
        const speed = 0.8;
        
        // Cassian follows
        const cassianDx = playerX - cassianX;
        const cassianDy = playerY - cassianY;
        cassianX += cassianDx * speed * 0.01;
        cassianY += cassianDy * speed * 0.01;
        
        // Charlie follows
        const charlieDx = playerX - charlieX;
        const charlieDy = playerY - charlieY;
        charlieX += charlieDx * speed * 0.01;
        charlieY += charlieDy * speed * 0.01;
        
        // Keep kids on screen
        cassianX = Math.max(25, Math.min(window.innerWidth - 75, cassianX));
        cassianY = Math.max(90, Math.min(window.innerHeight - 90, cassianY));
        charlieX = Math.max(25, Math.min(window.innerWidth - 75, charlieX));
        charlieY = Math.max(90, Math.min(window.innerHeight - 90, charlieY));
        
        cassian.style.left = cassianX + 'px';
        cassian.style.top = cassianY + 'px';
        charlie.style.left = charlieX + 'px';
        charlie.style.top = charlieY + 'px';
    }

    function startGame() {
        document.getElementById('startScreen').style.display = 'none';
        gameRunning = true;
        score = 0;
        timeLeft = 90;
        
        // Resume audio context
        if (audioContext.state === 'suspended') {
            audioContext.resume();
        }
        
        updateScore();
        updateTimer();
        
        gameTimer = setInterval(() => {
            timeLeft--;
            updateTimer();
            
            if (timeLeft <= 0) {
                endGame();
            }
        }, 1000);
        
        // More frequent spawning
        spawnTimer = setInterval(spawnCollectible, 800);
        
        // Random speech bubbles from kids
        bubbleTimer = setInterval(() => {
            if (Math.random() < 0.3) { // 30% chance every interval
                showSpeechBubble();
            }
        }, 4000);
    }

    function spawnCollectible() {
        if (!gameRunning) return;
        
        const positiveTypes = ['book', 'coffee', 'healthy-snack', 'running-shoe', 'croissant', 'tea'];
        const negativeTypes = ['dirty-dish', 'laundry'];
        const allTypes = [...positiveTypes, ...positiveTypes, ...positiveTypes, ...negativeTypes]; // 3:1 ratio
        
        const type = allTypes[Math.floor(Math.random() * allTypes.length)];
        
        const collectible = document.createElement('div');
        collectible.className = `collectible ${type}`;
        
        // Spawn away from tables and player
        let x, y, validPosition = false, attempts = 0;
        
        while (!validPosition && attempts < 20) {
            x = Math.random() * (window.innerWidth - 50);
            y = Math.random() * (window.innerHeight - 150) + 100;
            
            validPosition = true;
            
            // Check distance from tables
            tablePositions.forEach(table => {
                const distance = Math.sqrt((x - table.x) ** 2 + (y - table.y) ** 2);
                if (distance < 100) validPosition = false;
            });
            
            // Check distance from player
            const playerDistance = Math.sqrt((x - playerX) ** 2 + (y - playerY) ** 2);
            if (playerDistance < 80) validPosition = false;
            
            attempts++;
        }
        
        collectible.style.left = x + 'px';
        collectible.style.top = y + 'px';
        
        gameContainer.appendChild(collectible);
        collectibles.push(collectible);
        
        // Remove after 12 seconds if not collected
        setTimeout(() => {
            if (collectible.parentNode) {
                collectible.parentNode.removeChild(collectible);
                const index = collectibles.indexOf(collectible);
                if (index > -1) collectibles.splice(index, 1);
            }
        }, 12000);
    }

    function showSpeechBubble() {
        const kid = Math.random() < 0.5 ? cassian : charlie;
        const message = kidMessages[Math.floor(Math.random() * kidMessages.length)];
        
        const bubble = document.createElement('div');
        bubble.className = 'speech-bubble';
        bubble.textContent = message;
        
        const kidRect = kid.getBoundingClientRect();
        bubble.style.left = (kidRect.left + kidRect.width/2 - 60) + 'px';
        bubble.style.top = (kidRect.top - 50) + 'px';
        
        document.body.appendChild(bubble);
        
        setTimeout(() => {
            if (bubble.parentNode) {
                bubble.parentNode.removeChild(bubble);
            }
        }, 3000);
    }

    function checkCollisions() {
        collectibles.forEach((collectible, index) => {
            const rect1 = player.getBoundingClientRect();
            const rect2 = collectible.getBoundingClientRect();
            
            if (rect1.left < rect2.right && 
                rect1.right > rect2.left && 
                rect1.top < rect2.bottom && 
                rect1.bottom > rect2.top) {
                
                // Collision detected
                collectCollectible(collectible, index);
            }
        });
    }

    function collectCollectible(collectible, index) {
        const type = collectible.classList[1];
        let points = 0;
        let isNegative = false;
        
        switch(type) {
            case 'book': points = 25; break;
            case 'coffee': points = 20; break;
            case 'healthy-snack': points = 30; break;
            case 'running-shoe': points = 35; break;
            case 'croissant': points = 15; break;
            case 'tea': points = 18; break;
            case 'dirty-dish': points = -20; isNegative = true; break;
            case 'laundry': points = -15; isNegative = true; break;
        }
        
        score += points;
        if (score < 0) score = 0; // Don't go below 0
        updateScore();
        
        if (isNegative) {
            playNegativeSound();
            // Screen shake effect
            gameContainer.classList.add('screen-shake');
            setTimeout(() => {
                gameContainer.classList.remove('screen-shake');
            }, 500);
        } else {
            playCollectSound();
            createParticles(collectible);
        }
        
        // Remove collectible
        collectible.parentNode.removeChild(collectible);
        collectibles.splice(index, 1);
    }

    function createParticles(element) {
        const rect = element.getBoundingClientRect();
        for (let i = 0; i < 12; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = (rect.left + rect.width/2 + Math.random() * 40 - 20) + 'px';
            particle.style.top = (rect.top + rect.height/2 + Math.random() * 40 - 20) + 'px';
            document.body.appendChild(particle);
            
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            }, 3000);
        }
    }

    function updateScore() {
        document.getElementById('score').textContent = `Score: ${score}`;
    }

    function updateTimer() {
        document.getElementById('timer').textContent = `Time: ${timeLeft}`;
    }

    function endGame() {
        gameRunning = false;
        clearInterval(gameTimer);
        clearInterval(spawnTimer);
        clearInterval(bubbleTimer);
        
        playWinSound();
        
        let finalMessage = "";
        if (score >= 300) {
            finalMessage = "Happy Birthday From Charlie, Cassian and Dada! üéâüíï<br>You're absolutely incredible!";
        } else if (score >= 200) {
            finalMessage = "You completed your literary caf√© adventure! üìö‚òï<br>The kids are so proud of you!";
        } else {
            finalMessage = "33 years of being absolutely wonderful! ‚ú®üéÇ<br>We love you so much!";
        }
        
        setTimeout(() => {
            showPopup("üéâ Game Complete! üéâ", 
                `${finalMessage}<br><br>Final Score: ${score}<br><br>Cassian and Charlie: "Best mommy ever!" üëë`);
        }, 1000);
    }

    function showPopup(title, message) {
        document.getElementById('popupTitle').textContent = title;
        document.getElementById('popupMessage').innerHTML = message;
        document.getElementById('popup').style.display = 'block';
    }

    function closePopup() {
        document.getElementById('popup').style.display = 'none';
    }

    // Game loop
    function gameLoop() {
        if (gameRunning) {
            updateKidsPositions();
            checkCollisions();
        }
        requestAnimationFrame(gameLoop);
    }

    // Initialize everything
    window.addEventListener('load', () => {
        initGame();
        gameLoop();
    });

    // Handle orientation changes
    window.addEventListener('orientationchange', () => {
        setTimeout(() => {
            playerX = Math.min(playerX, window.innerWidth - 90);
            playerY = Math.min(playerY, window.innerHeight - 90);
            updatePlayerPosition();
        }, 100);
    });
</script>
</body>
</html>
</html>
<css>
/* All CSS is included in the HTML above for easier deployment */
</css>
<javascript>
/* All JavaScript is included in the HTML above for easier deployment */
</javascript>